---
title: "契約書200件超のデータ入力地獄を自動化して脱出した話                                     ー自動化の流れと実現のために工夫したことを紹介しますー｜株式会社スマートバンク"
source: "https://note.com/smartbankinc/n/n37957b011af8"
author:
  - "[[株式会社スマートバンク]]"
published: 2025-11-25
created: 2025-11-26
description: "はじめに  こんにちは! 株式会社スマートバンクで総務をやっている sakiと申します。  契約書や請求書など、書類から情報を読み取り入力する作業は、単純ながら時間と手間がかかる、大変な作業ですよね。 今回、この手入力作業を複数のツールを使って自動化しました。 AIと相談しながら進めることでやりたいことを実現できたので、「難しそうだな」と思わずに読んでいただけると嬉しいです！ 契約書に限らず、何かしらのデータ入力作業を効率化したい全ての方に、ぜひ読んでいただけたら嬉しいです。 この記事では、具体的にどんな作業を自動化したのか、使ったツールの選定理由、やりたいことを実現するために工夫した"
tags:
  - "clippings"
  - "自動化"
  - "ai"
  - "業務効率化"
  - "実務"
image: "https://assets.st-note.com/production/uploads/images/231836640/rectangle_large_type_2_6d0319e2fea680982067a1d80af6fbdd.png?fit=bounds&quality=85&width=1280"
---
![見出し画像](https://assets.st-note.com/production/uploads/images/231836640/rectangle_large_type_2_6d0319e2fea680982067a1d80af6fbdd.png?width=1280)

## 契約書200件超のデータ入力地獄を自動化して脱出した話 ー自動化の流れと実現のために工夫したことを紹介しますー

[株式会社スマートバンク](https://note.com/smartbankinc)

## はじめに

こんにちは! 株式会社スマートバンクで総務をやっている sakiと申します。

契約書や請求書など、書類から情報を読み取り入力する作業は、単純ながら時間と手間がかかる、大変な作業ですよね。  
今回、この手入力作業を複数のツールを使って自動化しました。 AIと相談しながら進めることでやりたいことを実現できたので、「難しそうだな」と思わずに読んでいただけると嬉しいです！  
契約書に限らず、 **何かしらのデータ入力作業を効率化したい全ての方** に、ぜひ読んでいただけたら嬉しいです。  
この記事では、具体的にどんな作業を自動化したのか、使ったツールの選定理由、やりたいことを実現するために工夫したこと、実際の効果について書きました。  
皆さんの業務効率化・AI活用の参考になれば幸いです!

## この記事がおすすめな方

以下のような方にぜひ読んでいただきたいです。

> **・日々のルーティン作業を効率化したい方**  
> **・データの入力作業を自動化したい方**  
> ・GoogleドライブやスプレッドシートなどGoogle Workspaceを利用している方  
> ・業務効率化をしたいけど、自分の業務の何をどう効率化できるのか分からないので、そのイメージを掴みたい方  
> ・生成AIに機密情報を渡して学習利用されてしまうのを懸念している方  
> ・法務部門や契約書管理を担当している方

## 従来の作業内容

従来は、以下の作業を人力で行っていました。

1.Googleドライブの契約書専用フォルダ直下に、会社ごとにフォルダがあり、各フォルダに契約書を中心としたデータが保存されています。

![画像](https://assets.st-note.com/img/1764045607-zKXB2C5LFkGUquIby91xoZQw.png?width=1200)

2.各会社フォルダを開くと、契約書以外にも見積書など関係ないデータがあるので、ファイル名を頼りに中身を確認して契約管理簿に入力すべき契約書を探します。

3.契約書を読んで、スプレッドシートに、以下の情報を入力します。

> \- 契約書表題  
> \- 契約相手方  
> \- 当社契約担当部門・MT  
> \- 契約締結日  
> \- 契約開始日  
> \- 契約終了日  
> \- 契約金額  
> \- 自動更新の有無  
> \- 契約状態  
> \- 契約書のリンク  
> \- 覚書、変更契約の有無  
> \- 覚書、変更契約のリンク  
> \- 契約終了後の秘密保持等制約の有無  
> \- 契約終了後の制約の終了日

![画像](https://assets.st-note.com/img/1764045730-ikQoIpTLKx6W8M5eUcbjPCE1.png?width=1200)

実際のスプレッドシート

## 使用したツール

### 1\. GAS(Google App Script)

### GASとは?

Google Workspace（Gmail、スプレッドシート、ドライブなど）のさまざまな機能を自動化・連携させることができるJavaScriptをベースとしたプログラミング言語です。

### 選定理由

今回の自動化のゴールは、Googleドライブにあるデータを読み込み、スプレッドシートに情報を入力することでした。  
GoogleドライブもスプレッドシートもGoogle製品のため、同じGoogle製品であるGASが最も連携しやすいと考えました。

### 2\. Gemini API(生成AI)

### Gemini APIとは？

Googleが開発した高性能なAIを、プログラムを通じて利用するための窓口です。データの中身を分析し、複雑な問いに答える **頭脳** の役割を果たします。

### 選定理由

選んだ理由は、主に以下の2点です。

1. Google製品との親和性: GASと同様にGoogle製品であるため、連携がスムーズです。
2. **渡したデータが学習に利用されない**: 契約書という機密情報をAIに読ませるにあたり、データが学習に利用されないことが必須条件でした。  
	[公式ドキュメント](https://ai.google.dev/gemini-api/terms?hl=ja#unpaid-services) によれば、Gemini APIは、 無料で利用する場合はサービスの改良にデータが使われますが、有料利用の場合は違反検出目的でのみ記録されます。スマートバンクではGemini APIを有料利用しているため、利用して問題ないと判断しました。

### 3\. Cursor

### Cursorとは?

ChatGPTのような対話形式で、プログラミングのコードをAIが自動で生成してくれたり、既存コードの修正を手伝ってくれたりする、AIに特化したエディタです。  
今回、GASのコードの生成にフル活用しました。コードはほぼ自力で書いていません。

### 選定理由

選んだ理由は、主に以下の2点です。

1. 基本機能が無料で使えるため。  
	同じ AIコードアシスタントである Claude Codeには無料プランがありませんでしたが、 Cursorは無料プランがあり、Proプランを14日間トライアルできるので、まず試しに使ってみたいという方におすすめです。
2. ChatGPTに書いてもらうのに比べてコードの **差分が分かりやすい** 。  
	Cursorはプロンプトを渡すとその内容に沿ってファイルの内容を更新してくれます。  
	その際、ファイルの内容のどこをアップデートしたのかを分かりやすく教えてくれます(緑が追加部分、赤が削除部分)。ページ下部のAccept Fileをクリックすると変更を一括で反映できますし、一箇所ずつAccept / Rejectをして自身で変更を取り入れる/ 削除することも可能です。
![画像](https://assets.st-note.com/img/1764045895-gJZ7cFUa0Yfk1yrTnWxOI3mS.png?width=1200)

ChatGPTもGASのコードを書いてくれますが、一発でやりたいことが実現できない場合、何度かやりとりすることになると思います。その際、どこが修正されたかぱっと分かりにくかったり、全体のコードを渡して欲しいのに、差分だけ渡されたりすることがあります。  
このような時、Cursorは上記のように差分を色付きで分かりやすく表示してくれ、ボタン一つでCursorが提案してくれたコードを取り入れるか・拒否するかを選択できて便利です。  
ただ、GASを書いたりGeminiを使ったりするのが初めてで慣れていない方は、一度にいろんなツールを使うと分からないことが多く負荷が大きいので、ChatGPTに書いてもらう方法でもいいと思います。

Cursorの詳しい使い方を知りたい方は、ぜひこちらの記事をご覧ください。

## 自動化の流れ

### 仕組み

複数のツールを使っていて複雑なので、どのツールに何をさせているか図にしました。  
以下のような流れになります。

  

![画像](https://assets.st-note.com/img/1764045972-w8eKaTiSm2pdRyqgxUGBrkCh.png?width=1200)

契約書入力の自動化フロー

1.処理の実行役であるGASが、Googleドライブ内の契約書フォルダを順番に巡回します。

2.フォルダ内に保管されているデータを取得し、OCRという技術を使ってデータ内の文字を読み取り、デジタル上のテキストに変換します。

3.Gemini(生成AI)に、2で取得した契約書の文字データと、「会社名」「契約相手方」「締結日」などスプレッドシートに入力したい項目を具体的に指示したプロンプトを渡します。※プロンプトとは、AIに指示や質問を伝えるための文章のことです。  
今回の例では以下のプロンプトを渡しました。

> 渡したPDFファイルについて、以下の情報を抽出してください。  
> \- 契約書表題  
> \- 契約相手方（株式会社スマートバンクは除外し、契約相手となる他社の会社名のみを抽出）  
> \- 契約締結日 (YYYY/MM/DD形式)  
> \- 契約開始日 (YYYY/MM/DD形式)：記載がなければ契約締結日の日付。  
> \- 契約終了日 (YYYY/MM/DD形式) ：自動更新が有りの場合は最新の契約終了日。(例えば１年毎に自動更新される場合は、今年or来年の日付を教えて)。自動更新がなければ空欄。  
> \- 自動更新の有無 (自動更新有り/自動更新無し)  
> \- 自動更新予定日(YYYY/MM/DD形式): 最新の契約終了日から1年後など、自動更新される日付。なければ空欄。  
> \- 契約状態 (有効・継続中/無効・終了)  
> \- 契約終了後の秘密保持等制約の有無 (制約有り/制約無し)  
> \- 秘密保持等制約がある場合、契約終了後の制約の終了日 (YYYY/MM/DD)：なければ空欄

4.Geminiが文字データの内容を分析し、スプレッドシートに入力させる情報をGASに返します。

5.GASがGeminiから返ってきた情報を受け取り、スプレッドシートに自動で書き込みます。

### より簡単な説明

上記の説明だと専門用語など多く少し難しいかもしれないので、より簡単に流れを説明します。  
登場人物は、以下の2つです。

1. GAS: 今回の自動化の **「司令塔(実行役)」**
2. Gemini API: 人間が契約書を読んで情報を読み取る作業を、代わりにやってくれる **「頭脳」**

以下のステップで1件ずつ、書類の情報を読む→入力する作業を行なっています。

1. GASが、契約書が入っているGoogleドライブ内のフォルダを一つずつ順番にチェックしに行きます。
2. PDFデータを見つけたら、文字を読み取り、契約書の内容を文字データに変換します。
3. 2で抜き出した文字データとGemini APIへの指示書(スプレッドシートに入力してほしい項目)をセットにして、AIに渡します。
4. Gemini API が渡された指示書をもとに、文字データを分析し、指示書に書かれた項目を探し出し、GASに教えてくれます。
5. GASは、 Gemini APIが教えてくれた情報をスプレッドシートに入力します。

### 実際に作成したGAS

実際に作成・実行したGASはこちらです。  
[https://gist.github.com/Saki-htr/bc819faba0183ff099c13e4703684b4c](https://gist.github.com/Saki-htr/bc819faba0183ff099c13e4703684b4c)

## やりたいことを実現するために工夫したこと

複雑な処理を自動化する上で、次の3つを行いました。

### 1\. まずはやりたいことが実現可能なのか、AIに壁打ちする

コードを書く前に、自分がやりたい自動化の処理がそもそも可能なのか、また、どのようなフローが最適かをCursorに壁打ちしました。  
どの生成AIに聞くかは好みで構いませんが、 GASを書いてもらうAIと同じものを使うと、背景などを理解してコードを書いてくれるため効率的だと思います。

具体的には、以下のプロンプトを渡しました。

> Googleドライブに取引先の会社ごとにフォルダを作り、契約書や覚書のPDFデータを保存しています。契約書ではないデータも一部含まれます。  
>   
> 以下の項目を自動で読み取り、スプレッドシートに入力したいです。  
> （契約書表題、契約相手方、契約締結日、自動更新の有無など約10項目を記載）  
>   
> これらを自動化したいです。使うツールやフローの設計を考えてください。

Cursorからは3つの案が提案されましたが、「契約書のフォーマットがほぼ一定であれば、GASとOCRを組み合わせる方法がコストを抑えつつ最も効率的」と勧められました。これにより、当初の予定通りGASを中心とした方法で進めることに決めました。

また、以下の課題についても実現可能か確認しました。

- 「取引先のフォルダの中に、契約書とは関係ないファイルも保存されています。これはスプレッドシートに入力しないでほしいです。それは可能ですか。」
- 「PDFかつ契約書ではないデータがある場合、入力させないようにするためにはどうしたらいいですか」

これらもGASで実現可能と分かったため、安心してGASの作成に取り掛かることができました。

### 2\. ステップごとにコードを生成してもらい検証しながら進める

自分のやりたいことが実現できそうと分かったところで、次に重要になるのが「コード生成の依頼方法」です。

今回の自動化は、

1. Googleドライブにアクセスし、
2. 取引先フォルダを巡回してPDF形式のデータのみを取得し、
3. OCR機能で契約書の内容を文字データとして抽出し、
4. Gemini APIにアクセスし、
5. 3で抽出した契約書の文字データとプロンプトを渡し、
6. 返ってきた情報をスプレッドシートに入力する

という複数の処理が組み合わさった複雑な流れになります。  
このようなケースで、 **いきなり一度のプロンプトで全ての処理を書かせようとすると、実行してエラーになった時に「なぜ・どこの処理で躓いているか」が分からなくなってしまいます。**  
そのため、 **「ステップごとに、Cursorにプロンプトを渡してGASを書いてもらい、実行して検証し、 結果が意図通りだったら次のステップに進む。」** という進め方をしました。

![画像](https://assets.st-note.com/img/1764046791-hTd5bXCEost7cKp0rgADZFOG.png?width=1200)

自動化のフロー

今回の例だと、以下のような流れで、Cursorと対話しながらGASを完成させました。

1. Cursorに「GASから指定したGoogleドライブにアクセスさせる」処理を書いてもらう(実際にアクセスできたことを確認するために、合わせてドライブ直下のフォルダ名をログに出力させる)
2. 実行して、アクセスできてるか確認する
3. アクセスできたので、「ドライブのフォルダ内を巡回してPDFデータだけを取得して、文字データを抽出してもらう」処理を追加してもらう(こちらも同様にログに出力してもらう)
4. 実行して、PDFデータのみ取得できているか、抽出した文字データが実際に読んでほしいファイルと同じか・実際のデータと同じ文字か確認する
5. 「抽出したデータと、Gemini APIへのプロンプトをGemini APIに送り、返ってきた情報をスプレッドシートに入力させる」処理を書いてもらう
6. スプレッドシートを確認して、内容が意図通りか確認する

このように、ステップごとにGASを作成・検証しながら作っていくことで、「今、Googleドライブにアクセスさせる処理だけを書いてるから、Gemini APIは関係ないな」というように原因の切り分けがしやすくなります。

### 3\. レート制限対策をする

### 実行前の対策

生成AIに限らず、WebサービスのAPIにアクセスする時、大抵の場合「レート制限」が設けられています。これは、一定時間内のリクエスト数を制限する仕組みです。  
今回の場合、契約書データが200件超あったため、レート制限を超えてGemini APIにリクエストを送れなくなる可能性が高いと考えました。  
そのため、GASの作成・検証時点では、すべての契約書ファイルを対象とせず、 **”最初に読んだPDFデータ10件のみ”** を処理させるように限定し、検証を進めました。  
コードが完成したら、以下のプロンプトを渡し、レート制限を超えないためのロジックをコードに書き加えてもらいました。

> 以下のドキュメントを参考に、Gemini API のレート制限を超えないようにコードを書き換えてください。  
> https://ai.google.dev/gemini-api/docs/rate-limits?hl=ja

### 実行後、レート制限に達してしまった場合の対処法

事前に気をつけていても、実行中にレート制限を超えてしまうことがあります。  
実行が途中で中断した場合、次回同じGASを実行すると、既に処理した契約書データが再び処理されてしまい、スプレッドシートに重複して入力されてしまいます。  
これを防ぐため、Cursorに **「すでに入力済みの契約書は処理をスキップする」** 処理を追加してもらいました。  
具体的には、スプレッドシート（契約管理簿）の項目にある「契約書データのリンク」を元に、新しいファイルを処理する前に既に処理していないかを確認する仕組みを実現することで、重複処理を防止しています。

## (おまけ) GASのコードを理解したいけど何から勉強したらいいか分からない方へ

GASのコードは、JavaScriptというプログラミング言語をベースに書かれています。  
そのため、GASの複雑な構文や書き方を覚えなくても、JavaScriptの基本的な書き方さえ分かれば、コードの理解度が格段にアップします。具体的には、 **「変数」「関数」「繰り返し処理」「条件分岐」** の4つを知るだけで、「よく分からない文字の羅列」が「一つ一つの具体的な処理」として読み解けるようになります。  
実際に、私は今回がGAS初挑戦でしたが、 JavaScriptの基礎知識があったおかげで、Cursorが生成したコードが何をしているのかを理解し、検証しながら進めることができました。  
  
プログラミングが全く初めての方は、まず **Progate** をやってみるのがおすすめです。私も最初にJavaScriptを学習した際にこちらを利用しましたが、 ゲーム感覚で楽しく学べたので **初学者の方に特におすすめ** です。

[**JavaScript入門** *JavaScriptはWebページに動きを加えるだけでなく、サーバーサイド開発にも利用できる汎用的なプログラミング言語です* *prog-8.com*](https://prog-8.com/courses/es6)

## 自動化の効果

### 約16時間の削減

今回、自動化のシステムの作成に7.5時間、GAS実行後の人力チェック・修正作業に15時間と、合計22.5時間かかりました。

この作業をすべて手動で行っていた場合、1件あたり10分と仮定すると、約230件の処理で38.3時間かかる想定でした。

そのため、この自動化により、 **約16時間の削減** を実現できました。

### AIの精度

AIに入力作業を一任できましたが、その結果が正確かどうか人間がチェックする必要があります。  
精度が高かった項目と、精度が低かった項目は以下の通りです。

- ほぼ100%正確だった項目:  
	契約書表題、契約相手方、契約締結日、契約開始日といった、 **契約書内の目立つ位置に明確に記載されている基本情報** の抽出は、ほぼ100%誤りがありませんでした。
- 精度が低かった項目:  
	以下の項目は、契約書によって構成や書き方が異なるためか、精度が微妙でした。
	- 契約状態：無効であるにもかかわらず「有効・継続中」と判断されるケースが多かったです。
	- 秘密保持等制約の有無：「制約無し」が正しいのに、ほとんどが「制約有り」になっていました。
	- 契約終了日 / 自動更新の有無 / 契約終了後の秘密保持等制約の有無 / 契約終了後の制約の終了日：6割程度が意図しない日付を返すことがありました。

### 脳のリソースも節約

入力の自動化を実現できても、その結果が正しいかは人が確認しなければなりません。  
そのため、確認作業に15時間と時間がかかってしまいましたが、 **「目で契約書の内容を確認し、入力する情報を読み取り、スプレッドシートに入力する」というキーボード手打ち作業と、この作業に集中力というリソースを割かずに済んだことによって、大きく負担が軽減された** と感じました。

  

## さいごに

今回の事例が、皆さんの業務効率化やAI活用への第一歩を踏み出すきっかけになれば幸いです。  
株式会社スマートバンクでは、 **エンジニアに限らず全ての職種がAIを積極的に活用** しています。

また、各種ポジションで採用をおこなっています。興味を持ってくださった方は、ぜひお気軽に下記のページからカジュアル面談などにお申し込みください。

[**採用情報 | 株式会社スマートバンク** *株式会社スマートバンクの採用情報です。私達の価値観や募集中の職種、メンバーを紹介しています。* *smartbank.co.jp*](https://smartbank.co.jp/recruit)

  

トリビア② アイコンのスラッシュの角度は43°です

契約書200件超のデータ入力地獄を自動化して脱出した話 ー自動化の流れと実現のために工夫したことを紹介しますー｜株式会社スマートバンク